## 编译遇到的问题

```shell
[root@localhost qemu-0.4.4]# make
for d in i386 i386-softmmu arm; do \
make -C $d all || exit 1 ; \
        done
make[1]: Entering directory `/root/qemu-0.4.4/i386'
gcc -static -Wl,-T,/root/qemu-0.4.4/i386-vl.ld -o vl vl.o block.o vga.o sdl.o libqemu.a  -lm -L/usr/lib -Wl,-rpath,/usr/lib -lSDL -lpthread -L/usr/X11R6/lib -lX11 -lXext -lXv -ldl
/usr/lib/libSDL.a(SDL_gamma.lo)(.text+0x9a): In function `CalculateGammaRamp':
: undefined reference to `pow'
/usr/lib/libSDL.a(SDL_gamma.lo)(.text+0x162): In function `CalculateGammaFromRamp':
: undefined reference to `log'
/usr/lib/libSDL.a(SDL_gamma.lo)(.text+0x172): In function `CalculateGammaFromRamp':
: undefined reference to `log'
collect2: ld returned 1 exit status
make[1]: *** [vl] Error 1
make[1]: Leaving directory `/root/qemu-0.4.4/i386'
make: *** [all] Error 1
```

很明显是没有连接math库,修改config-host.mak,增加`-lm`选项.

```shell
[root@localhost qemu-0.4.4]# cat config-host.mak
# Automatically generated by configure - do not modify
prefix=/usr/local
MAKE=make
CC=gcc
HAVE_GCC3_OPTIONS=yes
HOST_CC=gcc
AR=ar
STRIP=strip -s -R .comment -R .note
CFLAGS=-O2
LDFLAGS=
ARCH=i386
CONFIG_SDL=yes
SDL_LIBS=-L/usr/lib -Wl,-rpath,/usr/lib -lSDL -lpthread -lm
SDL_CFLAGS=-I/usr/include/SDL -D_REENTRANT
VERSION=0.4.4
SRC_PATH=/root/qemu-0.4.4
TARGET_DIRS=i386 i386-softmmu arm
```

## 调试小技巧

调试vl的时候,可以适当修改一下代码,将vl.c中main函数里面的nodisp置为1,这样就可以暂时不管显卡的相关代码.
